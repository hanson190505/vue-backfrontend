(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-459e61ed"],{"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},4876:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[n("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),n("el-breadcrumb-item",{attrs:{to:{path:"/orders"}}},[e._v("订单管理")]),n("el-breadcrumb-item",[e._v("明细列表")])],1),n("el-row",[n("el-col",{attrs:{span:4}},[n("backend-search",{on:{getSearchSuborder:e.getSearchSuborder,parentMethod:e.pagination}})],1),n("el-col",{attrs:{span:2}},[n("order-status",{on:{handleFilter:e.pagination}})],1),n("el-col",{attrs:{span:6}},[n("date-search",{on:{dateSearchDate:e.dateSearchDate}})],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{},attrs:{data:e.subOrderData,border:"","show-summary":"","highlight-current-row":"","summary-method":e.getSummaries,"row-class-name":e.tableRowClassName,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{select:e.handleSelect,"select-all":e.handleSelect}},[n("el-table-column",{attrs:{type:"selection",width:"60",align:"center"}}),n("el-table-column",{attrs:{prop:"tag",label:"标签",width:"80",align:"center",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popover",{attrs:{placement:"top-start",width:"80",trigger:"hover",content:e.popoverContent,disabled:e.popoverDisable(t.row)}},[n("el-tag",{attrs:{slot:"reference",type:t.row.type,"disable-transitions":""},slot:"reference"},[e._v(e._s(t.row.tag))])],1)]}}])}),n("el-table-column",{attrs:{label:"客户",align:"center",width:"100",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.order_number.customer))}})]}}])}),n("el-table-column",{attrs:{label:"订单编号",align:"center",width:"140",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.order_number.order_number))}})]}}])}),n("el-table-column",{attrs:{label:"下单日期",align:"center",width:"100",sortable:"",prop:"order_date",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.order_number.order_date))}})]}}])}),n("el-table-column",{attrs:{label:"订单交期",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.order_number.deliver_date))}})]}}])}),n("el-table-column",{attrs:{label:"产品名称",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.pro_name))}})]}}])}),n("el-table-column",{attrs:{label:"产品类别",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.proType[t.row.pro_item-1]))])]}}])}),n("el-table-column",{attrs:{label:"产品尺寸",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.pro_size))}})]}}])}),n("el-table-column",{attrs:{label:"产品颜色",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.pro_color))}})]}}])}),n("el-table-column",{attrs:{label:"产品包装",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.pro_pack))}})]}}])}),n("el-table-column",{attrs:{label:"产品描述",align:"center",width:"140","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.pro_desc))}})]}}])}),n("el-table-column",{attrs:{label:"数量",align:"center",width:"80",prop:"pro_qt"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.pro_qt))}})]}}])}),n("el-table-column",{attrs:{label:"单价($)",align:"center",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.pro_price))}})]}}])}),n("el-table-column",{attrs:{label:"重量(g)",align:"center",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.pro_weight))}})]}}])}),n("el-table-column",{attrs:{label:"汇率",align:"center",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"col-cont",domProps:{innerHTML:e._s(e.showDate(t.row.order_number.ex_rate))}})]}}])}),n("el-table-column",{attrs:{label:"订单金额($)",align:"center",width:"100",prop:"sub_amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("toThousandFilter")(t.row.sub_amount)))])]}}])}),n("el-table-column",{attrs:{label:"订单金额(¥)",align:"center",width:"100",prop:"rmb_amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(" "+e._s(e._f("toThousandFilter")(t.row.sub_amount*t.row.order_number.ex_rate))+" ")])]}}])}),n("el-table-column",{attrs:{label:"采购金额(¥)",align:"center",width:"100",prop:"purchaseAmount"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("toThousandFilter")(t.row.purchaseAmount)))])]}}])}),n("el-table-column",{attrs:{label:"出货金额(¥)",align:"center",width:"100",prop:"shipAmount"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("toThousandFilter")(t.row.shipAmount)))])]}}])}),n("el-table-column",{attrs:{label:"毛利(¥)",align:"center",width:"100",prop:"profit_rmb"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("toThousandFilter")(t.row.profit_rmb)))])]}}])}),n("el-table-column",{attrs:{label:"毛利($)",align:"center",width:"100",prop:"profit_usd"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("toThousandFilter")(t.row.profit_usd)))])]}}])})],1),n("pagi-nation",{attrs:{getDataTotal:e.dataTotal},on:{pagination:e.pagination}})],1)},r=[],o=(n("a623"),n("4160"),n("c975"),n("d81d"),n("13d5"),n("a9e3"),n("b680"),n("ac1f"),n("5319"),n("841c"),n("159b"),n("f8b7")),s=n("b59b"),i=n("d2c0"),l=n("6681"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.handleFilter},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)},u=[],d={name:"orderStatus",data:function(){return{value:"",options:[{value:"purchase",label:"待采购"},{value:"ship",label:"待出货"},{value:"acount",label:"待结算"},{value:"done",label:"已完成"}]}},methods:{handleFilter:function(e){""===e?this.$emit("handleFilter"):this.$emit("handleFilter",{val:e})}}},p=d,h=n("2877"),f=Object(h["a"])(p,c,u,!1,null,"526bff22",null),m=f.exports,b={components:{backendSearch:s["a"],pagiNation:i["a"],dateSearch:l["a"],orderStatus:m},data:function(){return{loading:!0,proType:["硅胶","五金","USB","移动电源","其他"],subOrderData:[],dataTotal:0,popoverContent:""}},methods:{dateSearchDate:function(e){e?this.pagination({start_date:e[0],end_date:e[1],argument:"date_search"}):this.pagination()},handleSelect:function(e){this.$emit("getSelectSuborder",e)},showDate:function(e){return e+="",-1!==e.indexOf(this.search)&&""!==this.search?e.replace(this.search,'<font color="#ff4400">'+this.search+"</font>"):e},pagination:function(e){var t=this;return e||(e={page:1,page_size:10}),Object(o["c"])(e).then((function(e){var n=e.data;t.dataTotal=n.count,t.loading=!1;var a=0,r=0;t.subOrderData=[],n.results.forEach((function(e){0!==e.purchases.length&&e.purchases.forEach((function(e){a+=1*e.purchase_amount})),0!==e.ships.length&&e.ships.forEach((function(e){r+=1*e.ship_cost}));var n={purchaseAmount:a,shipAmount:r,profit_rmb:e.sub_amount*e.order_number.ex_rate-a-r,profit_usd:e.sub_amount-(a+r)/e.order_number.ex_rate};t.subOrderData.push(Object.assign(e,n))}))}))},getSummaries:function(e){var t=e.columns,n=e.data,a=[];return t.forEach((function(e,t){if(0!==t){var r=n.map((function(t){return"rmb_amount"===e.property?Number(t.order_number.ex_rate*t.sub_amount):Number(t[e.property])}));r.every((function(e){return isNaN(e)}))?a[t]="N/A":(a[t]=r.reduce((function(e,t){var n=Number(t);return isNaN(n)?Math.floor(100*e)/100:Math.floor(100*e)/100+Math.floor(100*t)/100}),0),a[t].toFixed(2))}else a[t]="总计"})),a},tableRowClassName:function(e){var t=e.row;e.rowIndex;return 1===t.is_purchase&&(t.type="info",t.tag="待采购"),0===t.is_purchase&&1===t.is_ship&&(t.type="",t.tag="待出货"),0===t.is_purchase&&0===t.is_ship&&1===t.is_account&&(t.type="warning",t.tag="待结算"),0===t.is_purchase&&0===t.is_ship&&0===t.is_account&&(t.type="success",t.tag="已完成"),1===t.order_number.is_done&&1===t.is_ship&&(t.type="danger",t.tag="紧急!!"),""},popoverDisable:function(e){return 4!==e.order_number.is_done||1!==e.is_ship||(1===e.is_purchase&&(this.popoverContent="待采购"),0===e.is_purchase&&1===e.is_ship&&(this.popoverContent="待出货"),0===e.is_purchase&&0===e.is_ship&&1===e.is_account&&(this.popoverContent="待结算"),!1)},getSearchSuborder:function(e){this.subOrderData=e.results,this.dataTotal=e.count}},created:function(){this.pagination()}},_=b,g=Object(h["a"])(_,a,r,!1,null,"2d7b7d51",null);t["default"]=g.exports},6681:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd"},on:{change:function(t){return e.dateRangeChange(e.value)}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)},r=[],o={name:"dateSearch",data:function(){return{value:"",pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-6048e5),e.$emit("pick",[n,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-2592e6),e.$emit("pick",[n,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-7776e6),e.$emit("pick",[n,t])}}]}}},methods:{dateRangeChange:function(e){this.$emit("dateSearchDate",e)}}},s=o,i=n("2877"),l=Object(i["a"])(s,a,r,!1,null,"57cc3ee9",null);t["a"]=l.exports},"841c":function(e,t,n){"use strict";var a=n("d784"),r=n("825a"),o=n("1d80"),s=n("129f"),i=n("14c3");a("search",1,(function(e,t,n){return[function(t){var n=o(this),a=void 0==t?void 0:t[e];return void 0!==a?a.call(t,n):new RegExp(t)[e](String(n))},function(e){var a=n(t,e,this);if(a.done)return a.value;var o=r(e),l=String(this),c=o.lastIndex;s(c,0)||(o.lastIndex=0);var u=i(o,l);return s(o.lastIndex,c)||(o.lastIndex=c),null===u?-1:u.index}]}))},a623:function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").every,o=n("a640"),s=n("ae40"),i=o("every"),l=s("every");a({target:"Array",proto:!0,forced:!i||!l},{every:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},b59b:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-input",{attrs:{size:"mini",clearable:"",placeholder:"请输入关键字..."},on:{clear:e.handleSearchClear,input:e.handleInput},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendSearch(t)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.sendSearch},slot:"append"})],1)],1)},r=[],o=(n("ac1f"),n("841c"),{name:"backendSearch",data:function(){return{search:""}},methods:{handleInput:function(){""===this.search&&this.$emit("parentMethod")},sendSearch:function(){var e=this.search;if(e){var t={param:e};this.$emit("parentMethod",t)}},handleSearchClear:function(){this.$emit("parentMethod")}}}),s=o,i=n("2877"),l=Object(i["a"])(s,a,r,!1,null,"01077c5a",null);t["a"]=l.exports},d2c0:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,50,100,200],"page-size":e.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.getDataTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"prev-click":e.handleprevious,"next-click":e.handlenext}})],1)},r=[],o=(n("a9e3"),{name:"pagiNation",data:function(){return{page_size:10,currentPage:1}},props:{getDataTotal:{type:Number,default:0}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:1,page_size:e})},handleCurrentChange:function(e){this.$emit("pagination",{page:e,page_size:this.page_size})},handleprevious:function(e){this.$emit("pagination",{page:e,page_size:this.page_size})},handlenext:function(e){this.$emit("pagination",{page:e,page_size:this.page_size})}}}),s=o,i=n("2877"),l=Object(i["a"])(s,a,r,!1,null,"212aea47",null);t["a"]=l.exports},f8b7:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return p}));var a=n("6128"),r=n("4328"),o=n.n(r);function s(e){return Object(a["a"])({url:"orders/",params:e})}function i(e,t){return Object(a["a"])({url:"orders/".concat(e,"/"),params:t})}function l(e){return Object(a["a"])({url:"orders/",method:"post",params:{subtoken:window.sessionStorage.getItem("subtoken")},data:o.a.stringify(e)})}function c(e,t,n){return Object(a["a"])({url:"orders/".concat(e,"/"),method:"patch",params:t,data:o.a.stringify(n)})}function u(e){return Object(a["a"])({url:"suborders/",params:e})}function d(e,t,n){return Object(a["a"])({url:"suborders/".concat(e,"/"),method:"patch",params:t,data:o.a.stringify(n)})}function p(e){return Object(a["a"])({url:"suborders/",method:"post",params:{subtoken:window.sessionStorage.getItem("subtoken")},data:o.a.stringify(e)})}}}]);